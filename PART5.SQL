/*
    ZAD 1
 */

SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.ID_ZESP,
    ZESPOLY.NAZWA
FROM PRACOWNICY, ZESPOLY
WHERE PRACOWNICY.ID_ZESP = ZESPOLY.ID_ZESP
ORDER BY PRACOWNICY.NAZWISKO;

/*
    ZAD 2
 */

 SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.ID_ZESP,
    ZESPOLY.NAZWA
FROM PRACOWNICY, ZESPOLY
WHERE PRACOWNICY.ID_ZESP = ZESPOLY.ID_ZESP AND ZESPOLY.ADRES = 'PIOTROWO 3A'
ORDER BY PRACOWNICY.NAZWISKO;

/*
    ZAD 3
 */

SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.PLACA_POD,
    ETATY.PLACA_MIN,
    ETATY.PLACA_MAX
FROM PRACOWNICY, ETATY
WHERE PRACOWNICY.ETAT = ETATY.NAZWA
ORDER BY PRACOWNICY.ETAT, PRACOWNICY.NAZWISKO;

/*
    ZAD 4
 */

 SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.PLACA_POD,
    ETATY.PLACA_MIN,
    ETATY.PLACA_MAX,
    CASE
        WHEN ETATY.PLACA_MAX > PRACOWNICY.PLACA_POD AND PRACOWNICY.PLACA_POD > ETATY.PLACA_MIN THEN 'OK'
        ELSE 'NIE'
    END AS CZY_PENSJA_OK
FROM PRACOWNICY, ETATY
WHERE PRACOWNICY.ETAT = ETATY.NAZWA
ORDER BY PRACOWNICY.ETAT, PRACOWNICY.NAZWISKO;

/*
    ZAD 5
 */

 SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.PLACA_POD,
    ETATY.PLACA_MIN,
    ETATY.PLACA_MAX
FROM PRACOWNICY, ETATY
WHERE PRACOWNICY.ETAT = ETATY.NAZWA AND (ETATY.PLACA_MAX < PRACOWNICY.PLACA_POD OR PRACOWNICY.PLACA_POD < ETATY.PLACA_MIN)
ORDER BY PRACOWNICY.ETAT, PRACOWNICY.NAZWISKO;

/*
    ZAD 6
 */

  SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.PLACA_POD,
    ETATY.NAZWA AS KAT_PLAC,
    ETATY.PLACA_MIN,
    ETATY.PLACA_MAX
FROM PRACOWNICY, ETATY
WHERE ETATY.PLACA_MAX >= PRACOWNICY.PLACA_POD AND PRACOWNICY.PLACA_POD >= ETATY.PLACA_MIN
ORDER BY PRACOWNICY.NAZWISKO, KAT_PLAC;

/*
    ZAD 7
 */

  SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ETAT,
    PRACOWNICY.PLACA_POD,
    ETATY.NAZWA AS KAT_PLAC,
    ETATY.PLACA_MIN,
    ETATY.PLACA_MAX
FROM PRACOWNICY, ETATY
WHERE ETATY.PLACA_MAX >= PRACOWNICY.PLACA_POD AND PRACOWNICY.PLACA_POD >= ETATY.PLACA_MIN AND ETATY.NAZWA = 'SEKRETARKA'
ORDER BY PRACOWNICY.NAZWISKO, KAT_PLAC;

/*
    ZAD 8
 */

   SELECT
    PRACOWNICY.NAZWISKO,
    PRACOWNICY.ID_PRAC,
    SZEF.NAZWISKO AS SZEF,
    SZEF.ID_PRAC AS ID_SZEFA
FROM PRACOWNICY INNER JOIN PRACOWNICY SZEF ON PRACOWNICY.ID_SZEFA = SZEF.ID_PRAC
WHERE PRACOWNICY.ID_SZEFA IS NOT NULL
ORDER BY PRACOWNICY.NAZWISKO
