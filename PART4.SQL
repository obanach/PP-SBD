/*
    ZAD 1
 */

SELECT
    MIN(PLACA_POD) AS MINIMUM,
    MAX(PLACA_POD) AS MAKSIMUM,
    MAX(PLACA_POD) - MIN(PLACA_POD) AS ROZNICA
FROM PRACOWNICY;

/*
    ZAD 2
 */

SELECT
    ETAT, AVG(PLACA_POD) AS SREDNIA
FROM PRACOWNICY
    GROUP BY ETAT
    ORDER BY SREDNIA DESC;

/*
    ZAD 3
 */

SELECT
    COUNT('ID') AS PROFESOROWIE
FROM PRACOWNICY
    WHERE ETAT = 'PROFESOR';

/*
    ZAD 4
 */

SELECT
    ID_ZESP,
    SUM(PLACA_POD + COALESCE(PLACA_DOD,0)) AS SUMARYCZNE_PLACE
FROM PRACOWNICY
    GROUP BY ID_ZESP
    ORDER BY ID_ZESP;

/*
    ZAD 5
 */

SELECT
    MAX(SUM(PLACA_POD + COALESCE(PLACA_DOD,0))) AS MAKS_SUM_PRACA
FROM PRACOWNICY
    GROUP BY ID_ZESP;

/*
    ZAD 6
 */

 SELECT
    ID_SZEFA,
    MIN(PLACA_POD) AS MINIMALNA
 FROM PRACOWNICY
    WHERE ID_SZEFA IS NOT NULL
    GROUP BY ID_SZEFA
    ORDER BY MINIMALNA DESC;

/*
    ZAD 7
 */

 SELECT
    ID_ZESP,
    COUNT(*) AS ILU_PRACUJE
 FROM PRACOWNICY
    GROUP BY ID_ZESP
    ORDER BY ILU_PRACUJE DESC;

/*
    ZAD 8
 */

SELECT
    ID_ZESP,
    COUNT(ID_ZESP) AS ILU_PRACUJE
FROM PRACOWNICY
GROUP BY ID_ZESP HAVING COUNT(ID_ZESP) > 3
ORDER BY ILU_PRACUJE DESC;

/*
    ZAD 9
 */

SELECT
    ID_PRAC
FROM PRACOWNICY
GROUP BY ID_PRAC HAVING COUNT(ID_PRAC) > 1;

/*
    ZAD 10
 */

SELECT
    ETAT,
    AVG(PLACA_POD) AS SREDNIA,
    COUNT(ETAT) AS LICZBA
FROM PRACOWNICY WHERE EXTRACT(YEAR FROM ZATRUDNIONY) <= 1990
GROUP BY ETAT
ORDER BY ETAT;

/*
    ZAD 11
 */

SELECT
    ID_ZESP,
    ETAT,
    ROUND(AVG(PLACA_POD + COALESCE(PLACA_DOD,0)), 0) AS SREDNIA,
    ROUND(MAX(PLACA_POD + COALESCE(PLACA_DOD,0)), 0) AS MAKSYMALNA
FROM PRACOWNICY WHERE ETAT IN ('ASYSTENT', 'PROFESOR')
GROUP BY ID_ZESP, ETAT
ORDER BY ID_ZESP;

/*
    ZAD 12
 */

SELECT
    EXTRACT (YEAR FROM ZATRUDNIONY) AS ROK,
    COUNT(EXTRACT (YEAR FROM ZATRUDNIONY) ) AS ILU_PRACOWNIKOW
FROM PRACOWNICY
GROUP BY EXTRACT (YEAR FROM ZATRUDNIONY)
ORDER BY ROK;

/*
    ZAD 13
 */

SELECT
    LENGTH(NAZWISKO) AS ILE_LITER,
    COUNT(NAZWISKO) AS W_ILU_NAZWISKACH
FROM PRACOWNICY
GROUP BY LENGTH(NAZWISKO)
ORDER BY ILE_LITER;

/*
    ZAD 14
 */

SELECT
    COUNT(NAZWISKO) AS ILE_NAZWISK_Z_A
FROM PRACOWNICY WHERE INSTR(NAZWISKO, 'A', 1, 1) > 0;

/*
    ZAD 15
 */

SELECT
    COUNT(CASE
        WHEN INSTR(NAZWISKO, 'A', 1, 1) > 0 THEN 1
    END) AS ILE_Z_A,
    COUNT(CASE
        WHEN INSTR(NAZWISKO, 'E', 1, 1) > 0 THEN 1
    END) AS ILE_Z_E
FROM PRACOWNICY;

/*
    ZAD 16
    Dla każdego zespołu wyświetl jego identyfikator, sumę płac pracowników w nim zatrudnionych oraz listę pracowników
    w formie: nazwisko:podstawowa płaca pracownika. Dane pracowników na liście mają zostać oddzielone średnikami.
    Wynik posortuj wg identyfikatorów zespołów.

 */

SELECT
    ID_ZESP,
    SUM(PLACA_POD) AS SUMA_PLAC,
    LISTAGG(NAZWISKO || ':' || PLACA_POD,';') WITHIN GROUP ( ORDER BY NAZWISKO ) AS PRACOWNICY
FROM PRACOWNICY
GROUP BY ID_ZESP
ORDER BY ID_ZESP;

