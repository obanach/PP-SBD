/*
    ZAD 1
 */

SELECT
    MIN(PLACA_POD) AS MINIMUM,
    MAX(PLACA_POD) AS MAKSIMUM,
    MAX(PLACA_POD) - MIN(PLACA_POD) AS ROZNICA
FROM PRACOWNICY;

/*
    ZAD 2
 */

SELECT
    ETAT, AVG(PLACA_POD) AS SREDNIA
FROM PRACOWNICY
    GROUP BY ETAT
    ORDER BY SREDNIA DESC;

/*
    ZAD 3
 */

SELECT
    COUNT('ID') AS PROFESOROWIE
FROM PRACOWNICY
    WHERE ETAT = 'PROFESOR';

/*
    ZAD 4
 */

SELECT
    ID_ZESP,
    SUM(PLACA_POD + COALESCE(PLACA_DOD,0)) AS SUMARYCZNE_PLACE
FROM PRACOWNICY
    GROUP BY ID_ZESP
    ORDER BY ID_ZESP;

/*
    ZAD 5
 */

SELECT
    MAX(SUM(PLACA_POD + COALESCE(PLACA_DOD,0))) AS MAKS_SUM_PRACA
FROM PRACOWNICY
    GROUP BY ID_ZESP;

/*
    ZAD 6
 */

 SELECT
    ID_SZEFA,
    MIN(PLACA_POD) AS MINIMALNA
 FROM PRACOWNICY
    WHERE ID_SZEFA IS NOT NULL
    GROUP BY ID_SZEFA
    ORDER BY MINIMALNA DESC;

/*
    ZAD 7
 */

 SELECT
    ID_ZESP,
    COUNT(*) AS ILU_PRACUJE
 FROM PRACOWNICY
    GROUP BY ID_ZESP
    ORDER BY ILU_PRACUJE DESC;

/*
    ZAD 8
 */

SELECT
    ID_ZESP,
    COUNT(ID_ZESP) AS ILU_PRACUJE
FROM PRACOWNICY
GROUP BY ID_ZESP HAVING COUNT(ID_ZESP) > 3
ORDER BY ILU_PRACUJE DESC;

/*
    ZAD 9
 */

SELECT
    ID_PRAC
FROM PRACOWNICY
GROUP BY ID_PRAC HAVING COUNT(ID_PRAC) > 1;

/*
    ZAD 10
 */

SELECT
    ETAT,
    AVG(PLACA_POD) AS SREDNIA,
    COUNT(ETAT) AS LICZBA
FROM PRACOWNICY WHERE EXTRACT(YEAR FROM ZATRUDNIONY) <= 1990
GROUP BY ETAT
ORDER BY ETAT;

/*
    ZAD 11
 */

SELECT
    ID_ZESP,
    ETAT,
    ROUND(AVG(PLACA_POD + COALESCE(PLACA_DOD,0)), 0) AS SREDNIA,
    ROUND(MAX(PLACA_POD + COALESCE(PLACA_DOD,0)), 0) AS MAKSYMALNA
FROM PRACOWNICY WHERE ETAT IN ('ASYSTENT', 'PROFESOR')
GROUP BY ID_ZESP, ETAT
ORDER BY ID_ZESP;

/*
    ZAD 12
 */

SELECT
    EXTRACT (YEAR FROM ZATRUDNIONY) AS ROK,
    COUNT(EXTRACT (YEAR FROM ZATRUDNIONY) ) AS ILU_PRACOWNIKOW
FROM PRACOWNICY
GROUP BY EXTRACT (YEAR FROM ZATRUDNIONY)
ORDER BY ROK;

/*
    ZAD 12
 */

 
